<!DOCTYPE html>
<html lang="en">

<head>
    <title>ExoForm example 14</title>
    <meta name="color-scheme" content="dark">
    <link rel="stylesheet" href="css/main.css" />
</head>

<body>
    <h1>ExoForm example 14 - Two Way Databinding</h1>
    <section id="form"></section>

    <button id="ext-btn">Update model</button>

    <script type="module" src="https://xo-js.dev/v1.4/xo.js"></script>
    <script type="module">
        
        let sharedData = {
            comments: "My comment"
        };

        xo.form.bind(e => {
            if (e.state === "ready" && e.instances.data)
                sharedData = e.instances.data

        });

        document.querySelector("#ext-btn").addEventListener("click", e => {
            sharedData.comments = "Hello there!";
        })

        const schema = {
            model: {
                instance: {
                    data: sharedData
                }
            },
            pages: [{
                fields: [
                    {
                        type: "name",
                        name: "name",
                        caption: "Enter your name"
                    },
                    { // adding extra field
                        type: "multiline",
                        caption: "Your comments",
                        autogrow: true,
                        bind: "instance.data.comments"
                    }
                ]
            }]
        }

        // adding options
        document.getElementById("form").appendChild(await xo.form.run(schema, {
            on: {
                post: e => {
                    alert(JSON.stringify(e.detail.postData, null, 2))
                }
            }
        }));
    </script>
</body>

</html>